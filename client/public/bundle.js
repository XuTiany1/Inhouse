var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,r;function c(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function h(){return p(" ")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.data!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function v(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}class w{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){var o;this.e||(this.is_svg?this.e=(o=e.nodeName,document.createElementNS("http://www.w3.org/2000/svg",o)):this.e=f(11===e.nodeType?"TEMPLATE":e.nodeName),this.t="TEMPLATE"!==e.tagName?e:e.content,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)l(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(u)}}function b(t){r=t}function _(t){(function(){if(!r)throw new Error("Function called outside component initialization");return r})().$$.on_mount.push(t)}const x=[],k=[];let E=[];const L=[],T=Promise.resolve();let N=!1;function j(t){E.push(t)}const S=new Set;let C=0;function O(){if(0!==C)return;const t=r;do{try{for(;C<x.length;){const t=x[C];C++,b(t),A(t.$$)}}catch(t){throw x.length=0,C=0,t}for(b(null),x.length=0,C=0;k.length;)k.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];S.has(e)||(S.add(e),e())}E.length=0}while(x.length);for(;L.length;)L.pop()();N=!1,S.clear(),b(t)}function A(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const M=new Set;let P;function q(t,e){t&&t.i&&(M.delete(t),t.i(e))}function R(t,n,s,a){const{fragment:r,after_update:c}=t.$$;r&&r.m(n,s),a||j((()=>{const n=t.$$.on_mount.map(e).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),c.forEach(j)}function D(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];E.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),E=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e){-1===t.$$.dirty[0]&&(x.push(t),N||(N=!0,T.then(O)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(e,i,s,a,c,l,d,f=[-1]){const p=r;b(e);const h=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(p?p.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:i.target||p.$$.root};d&&d(h.root);let g=!1;if(h.ctx=s?s(e,i.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return h.ctx&&c(h.ctx[t],h.ctx[t]=i)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](i),g&&U(e,t)),n})):[],h.update(),g=!0,o(h.before_update),h.fragment=!!a&&a(h.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);h.fragment&&h.fragment.l(t),t.forEach(u)}else h.fragment&&h.fragment.c();i.intro&&q(e.$$.fragment),R(e,i.target,i.anchor,i.customElement),O()}b(p)}class G{$destroy(){D(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function J(t,e,n){const o=t.slice();return o[2]=e[n],o}function B(e){let n;return{c(){n=f("div"),n.textContent="It's quiet here...",m(n,"class","empty-message")},m(t,e){l(t,n,e)},p:t,d(t){t&&u(n)}}}function F(t){let e,n=t[0],o=[];for(let e=0;e<n.length;e+=1)o[e]=H(J(t,n,e));return{c(){e=f("div");for(let t=0;t<o.length;t+=1)o[t].c();m(e,"class","list-container")},m(t,n){l(t,e,n);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null)},p(t,i){if(3&i){let s;for(n=t[0],s=0;s<n.length;s+=1){const a=J(t,n,s);o[s]?o[s].p(a,i):(o[s]=H(a),o[s].c(),o[s].m(e,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(t){t&&u(e),d(o,t)}}}function H(t){let e,n,o,s,a,r=t[2]+"";return{c(){e=f("div"),n=p("📄   "),o=p(r),m(e,"class","history-item")},m(r,u){l(r,e,u),c(e,n),c(e,o),s||(a=g(e,"click",(function(){i(t[1](t[2]))&&t[1](t[2]).apply(this,arguments)})),s=!0)},p(e,n){t=e,1&n&&r!==(r=t[2]+"")&&y(o,r)},d(t){t&&u(e),s=!1,a()}}}function Q(e){let n,o,i,s;function a(t,e){var n;return 1&e&&(s=null),null==s&&(n=t[0],s=!!(n&&n.length>0)),s?F:B}let r=a(e,-1),d=r(e);return{c(){n=f("div"),o=f("div"),o.textContent="History",i=h(),d.c(),m(o,"class","title"),m(n,"class","wrapper")},m(t,e){l(t,n,e),c(n,o),c(n,i),d.m(n,null)},p(t,[e]){r===(r=a(t,e))&&d?d.p(t,e):(d.d(1),d=r(t),d&&(d.c(),d.m(n,null)))},i:t,o:t,d(t){t&&u(n),d.d()}}}function W(t,e,n){let{historyList:o=[]}=e,{fetchResponse:i}=e;return t.$$set=t=>{"historyList"in t&&n(0,o=t.historyList),"fetchResponse"in t&&n(1,i=t.fetchResponse)},[o,i]}class z extends G{constructor(t){super(),I(this,t,W,Q,s,{historyList:0,fetchResponse:1})}}function X(t,e,n){const o=t.slice();return o[25]=e[n],o}function K(t){let e,n,i,s,a,r;return{c(){e=f("div"),n=f("input"),i=h(),s=f("button"),s.textContent="Sync",m(n,"type","text"),m(n,"placeholder","Share link to a folder...")},m(o,u){l(o,e,u),c(e,n),$(n,t[7]),c(e,i),c(e,s),a||(r=[g(n,"input",t[15]),g(s,"click",t[10])],a=!0)},p(t,e){128&e&&n.value!==t[7]&&$(n,t[7])},d(t){t&&u(e),a=!1,o(r)}}}function V(t){let e,n,o,i,s,a,r,d,g,$,v=t[25].tag+"",b=t[25].document_name+"",_=t[25].block+"";return{c(){e=f("div"),n=f("div"),o=new w(!1),i=h(),s=f("p"),a=p(b),r=h(),d=f("p"),g=p(_),$=h(),o.a=i,m(s,"class","docname"),m(n,"class","title-tag"),m(e,"class","wrapper-block")},m(t,u){l(t,e,u),c(e,n),o.m(v,n),c(n,i),c(n,s),c(s,a),c(e,r),c(e,d),c(d,g),c(e,$)},p(t,e){8&e&&v!==(v=t[25].tag+"")&&o.p(v),8&e&&b!==(b=t[25].document_name+"")&&y(a,b),8&e&&_!==(_=t[25].block+"")&&y(g,_)},d(t){t&&u(e)}}}function Y(t){let e,n,i,s,r,b,_,x,k,E,L,T,N,j,S,C,O,A,U,I,G,J,B,F,H,Q,W,Y,Z,tt,et,nt,ot,it,st,at,rt,ct,lt;n=new z({props:{historyList:t[4],fetchResponse:t[11]}});let ut=t[6]&&K(t),dt=t[3],ft=[];for(let e=0;e<dt.length;e+=1)ft[e]=V(X(t,dt,e));return{c(){var o,c,l;e=f("div"),(o=n.$$.fragment)&&o.c(),i=h(),s=f("div"),r=f("div"),b=f("h1"),b.textContent="inhouse 🏠",_=h(),x=f("div"),k=f("div"),E=f("input"),L=h(),T=f("button"),T.textContent="🔍",N=h(),j=f("div"),S=f("div"),C=f("label"),O=p("📥    Upload\n            "),A=f("input"),U=h(),I=f("div"),G=f("label"),J=f("img"),F=p("   Sync Drive\n            "),H=f("input"),Q=h(),ut&&ut.c(),W=h(),Y=f("p"),Z=p(t[2]),tt=h(),et=f("div"),nt=f("p"),ot=f("b"),it=p(t[5]),st=new w(!1),at=h();for(let t=0;t<ft.length;t+=1)ft[t].c();m(e,"class","row"),m(E,"placeholder","Ask a question."),m(E,"class","searchbar"),m(E,"type","text"),m(T,"class","submit-button"),m(k,"class","input-container"),m(x,"class","search-container"),m(A,"id","fileInput"),m(A,"type","file"),v(A,"display","none"),A.multiple=!0,m(C,"for","fileInput"),m(C,"class","upload-button"),m(S,"class","upload-button-container"),c=J.src,l=B="https://upload.wikimedia.org/wikipedia/commons/1/12/Google_Drive_icon_%282020%29.svg",a||(a=document.createElement("a")),a.href=l,c!==a.href&&m(J,"src","https://upload.wikimedia.org/wikipedia/commons/1/12/Google_Drive_icon_%282020%29.svg"),m(J,"alt","google drive icon"),m(H,"type","text"),v(H,"display","none"),m(G,"class","gdrive-button"),m(I,"class","gdrive-button-container"),m(j,"class","uploads"),m(Y,"class","custom-i"),m(r,"class","top-bar"),m(ot,"class","query"),st.a=null,m(nt,"class","response"),m(et,"class","wrapper-response"),m(s,"class","row-bar")},m(o,a){l(o,e,a),R(n,e,null),l(o,i,a),l(o,s,a),c(s,r),c(r,b),c(r,_),c(r,x),c(x,k),c(k,E),$(E,t[0]),c(k,L),c(k,T),c(r,N),c(r,j),c(j,S),c(S,C),c(C,O),c(C,A),c(j,U),c(j,I),c(I,G),c(G,J),c(G,F),c(G,H),c(r,Q),ut&&ut.m(r,null),c(r,W),c(r,Y),c(Y,Z),c(s,tt),c(s,et),c(et,nt),c(nt,ot),c(ot,it),st.m(t[1],nt),c(et,at);for(let t=0;t<ft.length;t+=1)ft[t]&&ft[t].m(et,null);rt=!0,ct||(lt=[g(E,"input",t[14]),g(E,"keydown",t[12]),g(T,"click",t[8]),g(A,"change",t[13]),g(H,"click",t[9])],ct=!0)},p(t,[e]){const o={};if(16&e&&(o.historyList=t[4]),n.$set(o),1&e&&E.value!==t[0]&&$(E,t[0]),t[6]?ut?ut.p(t,e):(ut=K(t),ut.c(),ut.m(r,W)):ut&&(ut.d(1),ut=null),(!rt||4&e)&&y(Z,t[2]),(!rt||32&e)&&y(it,t[5]),(!rt||2&e)&&st.p(t[1]),8&e){let n;for(dt=t[3],n=0;n<dt.length;n+=1){const o=X(t,dt,n);ft[n]?ft[n].p(o,e):(ft[n]=V(o),ft[n].c(),ft[n].m(et,null))}for(;n<ft.length;n+=1)ft[n].d(1);ft.length=dt.length}},i(t){rt||(q(n.$$.fragment,t),rt=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(M.has(t))return;M.add(t),P.c.push((()=>{M.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}(n.$$.fragment,t),rt=!1},d(t){t&&u(e),D(n),t&&u(i),t&&u(s),ut&&ut.d(),d(ft,t),ct=!1,o(lt)}}}function Z(t,e,n){let o,i,s="",a="Ready to take your questions!",r="",c="",l=[],u=[],d="",f=!1,p=!1;async function h(){const t=await fetch(`./get_history_list/${c}`),e=await t.json();t.ok?n(4,u=e.queries):n(4,u=["Could not load history"])}async function g(){const t=await fetch(`./get_uploaded_count/${c}`);return await t.text()}async function m(){const t=await g();n(2,r="0"!==t?"1"!==t?t+" files indexed.":t+" file indexed":"Upload files to get started!")}async function y(){if(n(1,a=""),""===s)return void n(1,a="No text :(");if("Upload files to get started!"===r)return void n(1,a="Upload files first");p=!0,n(5,d=""),n(1,a="Waiting for the LLM..."),n(3,l=[]);const t=(await fetch(`./search/${c}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/x-ndjson"},body:JSON.stringify({value:s})})).body.getReader(),e=[];for(n(1,a="Waiting for the LLM..."),n(3,l=[]);;){const{done:o,value:i}=await t.read();if(o)break;const r=(new TextDecoder).decode(i),c=JSON.parse(r);if(c.response){n(5,d="Q: "+s),n(1,a=c.response.result),n(3,l=c.response.blocks);break}e.push(c.status),n(1,a=e[e.length-1]),await h()}}return _((async()=>{await async function(){const t=window.location.pathname.split("/"),e=t[t.length-1];c=e}(),await m(),await h(),await async function(){n(2,r="Syncing with Google Drive...");const t=await fetch(`https://inhouse.up.railway.app/app/sync_google/${c}/`),e=await t.json();if("X"===e.Message)await m();else{const t=await g();n(2,r=e.Message+". "+t+" indexed.")}return e}()})),[s,a,r,l,u,d,f,i,y,async function(){n(6,f=!0)},async function(){if(n(6,f=!1),""===i)return void n(2,r="URL is empty :(");n(2,r="Loading your Google Drive folder...");const t=await fetch(`./upload_google_file/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:i})}),e=await t.json(),o=await g();n(2,r=e.Message+" "+o+" indexed."),await h()},async function(t){const e=await fetch(`./get_response_from_query/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:t})});if(e.ok){const t=await e.json();n(1,a=t.result),n(5,d="Q: "+t.query),n(3,l=t.blocks)}else n(1,a="Error fetching response.")},function(t){"Enter"!==t.key||p||y()},function(t){o=t.target,async function(){n(2,r="Uploading...");const t=new FormData,e=["image/jpeg","image/png","image/gif","image/svg+xml","image/webp"];let i=[];for(let n=0;n<o.files.length;n++)e.includes(o.files[n].type)?i.push(o.files[n].name):t.append("files[]",o.files[n]);const s=await fetch(`./upload_file/${c}`,{method:"POST",body:t});if(i.length>0){const t=`Could not upload the following files. Image type files are not allowed: ${i.join(", ")}`;alert(t)}await s.json(),m()}()},function(){s=this.value,n(0,s)},function(){i=this.value,n(7,i)}]}return new class extends G{constructor(t){super(),I(this,t,Z,Y,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
